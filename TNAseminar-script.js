let talks = [
    {
        ymd: "2023-05-16",
        start: "1500",
        title: "Cluster-additive functions and frieze patterns with coefficients",
        speaker: "Antoine de Saint Germain",
        affil: "University of Hong Kong 香港大學",
        abstract: `
        <p>
            In his study of combinatorial features of cluster categories and cluster-tilted
            algebras, Ringel introduced an analogue of additive functions of stable translation quivers
            called cluster-additive functions.
        </p>
        <p>
            In the first part of this talk, we will define cluster-additive functions associated to any
            acyclic mutation matrix, relate them to mutations of the cluster X variety, and realise their
            values as certain compatibility degrees between functions on the cluster A variety
            associated to the Langlands dual mutation matrix (in accordance with the philosophy of
            Fock-Goncharov). This is based on joint work with Peigen Cao and Jiang-Hua Lu.
            In the second part of this talk, we will introduce the notion of frieze patterns with
            coefficients based on joint work with Min Huang and Jiang-Hua Lu. We will then discuss
            their connection with cluster-additive functions.
        </p>`,
        lang: "en",
        // access: {
        //     id: `872 4679 8561`,
        //     psw: `124239`,
        // },
        // record: {
        //     slides: `TNA/2023/deSaintGermain-Cluster-additive_functions_frieze_patterns_with_coefficients.pdf`,
        // },
    },
    {
        ymd: "2023-04-28",
        start: "1300",
        title: `Full exceptional collections associated with Bridgeland stability conditions`,
        speaker: "Takumi Otani 大谷 拓己",
        affil: "Osaka University 大阪大学",
        web: "https://otanit0907.github.io/Homepage/",
        abstract: `<p>The space of Bridgeland stability conditions on a triangulated category is important in mirror symmetry and many people develop various techniques to study it.
        In order to study the homotopy type of the space of stability conditions, Macri studied stability conditions associated with full exceptional collections.
        Based on his work, Dimitrov-Katzarkov introduced the notion of a full $\\sigma$-exceptional collection for a stability condition $\\sigma$.</p>
        
        <p>In this talk, I will explain the relationship between full exceptional collections and stability conditions and some properties. I will also talk about the existence of full $\\sigma$-exceptional collections for the derived category of an acyclic quiver.</p>
        `,
        lang: "jp",
        access: {
            id: `845 8271 9240`,
            psw: `737100`,
        },
        // record: {
        //     slides: `TNA/2023/Otani-Full_exceptional_collections_associated_with_Bridgeland_stability_conditions.pdf`,
        // },
    },
    {
        ymd: "2023-04-21",
        start: "1300",
        title: `Categorifications of deformed Cartan matrices`,
        speaker: "Kota Murakami 村上 浩大",
        affil: "Tokyo University 東京大学",
        abstract: `<p>In a series of works of Gei&szlig;-Leclerc-Schröer, they
        introduced a version of preprojective algebra associated with a
        symmetrizable generalized Cartan matrix and its symmetrizer. For
        finite type, it can be regarded as an un-graded analogue of Jacobian
        algebra of certain quiver with potential appeared in the theory of
        (monoidal) categorification of cluster algebras.</p>
        
        <p>In this talk, we will present an interpretation of graded structures
        of the preprojective algebra of general type, in terms of a
        multi-parameter deformation of generalized Cartan matrix and relevant
        combinatorics motivated from several contexts in the theory of quantum
        loop algebras or quiver $\\mathcal{W}$-algebras. From the vantage point
        of the representation theory of preprojective algebra, we will prove
        several purely combinatorial properties of these concepts. This talk
        is based on a joint work with Ryo Fujita (RIMS).</p>
        `,
        lang: "jp",
        access: {
            id: `816 5650 5440`,
            psw: `505258`,
        },
        record: {
            slides: `TNA/2023/Murakami-Categorifications_of_deformed_Cartan_matrices.pdf`,
        },
    },
    {
        ymd: "2023-02-10",
        start: "1700",
        title: `Silting discrete代数上のsemibrick複体とspherical objects`,
        speaker: "Wahei Hara 原 和平",
        affil: "University of Glasgow",
        web: "https://sites.google.com/view/waheihara/",
        abstract: `Silting discrete代数は導来圏のt構造に関してある種の離散性を満たす有限次元代数であり，代数の表現論の分野で研究されている．(semi)brick複体は導来圏の対象であって，単純加群(の直和)が持つ性質を一般化した条件で定義される．本講演ではまず「silting discrete代数上のsemibrick複体は，実際にとある有界t構造の核として現れる部分Abel圏の単純対象の直和である」という分類結果について紹介する．実際はより強く，負の次数の自己Extが消滅するという条件で，ある有界t構造の核に含まれる対象が特徴づけられるという定理を証明し，semibrick複体の分類はその系となる．
        後半では幾何学的な側面について紹介する．ある3次元フロップ収縮に対して，Donovan-Wemyssによって定義されたcontraction algebraという有限次元代数はsilting discrete代数の例を与える．このときbrick複体はSeidel-Thomasによって定義されたspherical objectの一般化として捉えることができ，代数幾何やシンプレクティック幾何において自己同値群の決定問題やBridgeland安定性条件の空間の連結性の問題と絡む，幾何学的にも重要な対象である．この背景をもう少し詳しく整理したのち，前半のsemibrick複体の分類結果で用いる手法がこの幾何学的状況にも拡張し，この分野の中心問題のひとつであるspherical objectの分類定理を導くことを紹介する．同様の手法は2次元Kleinian特異点の部分クレパント解消に対しても機能し，これら全ての状況で，null圏と呼ばれる導来圏の部分三角圏の有界t構造の分類や，Bridgeland安定性条件の空間の連結性などを導く．本講演の内容は全てMichael Wemyss氏との共同研究です．`,
        lang: "jp",
        access: {
            id: `872 4679 8561`,
            psw: `124239`,
        },
        record: {
            slides: `TNA/2023/Hara-Semibrick_complexes_and_spherical_twist_for_silting_discrete_algebras.pdf`,
        },
    },
    {
        ymd: "2023-01-20",
        start: "1030",
        title: `Tropical cluster transformations and train track splittings`,
        speaker: "Shunske Kano 狩野 隼輔",
        affil: "Tohoku University 東北大学",
        web: "https://sites.google.com/view/shunsuke-kano",
        abstract: `Fock-Goncharovは箙に対し、クラスター代数と呼ばれる組み合わせ構造を持つような概形であるクラスター多様体を定義した。
        この概形は良い正値性を持つことから、半体値集合を考えることができる。
        箙が点付き曲面の三角形分割から得られるとき、トロピカル半体値集合は曲面の測度付き葉層構造の空間の適切な拡張と同一視される。
        クラスター多様体のトロピカル半体値集合はクラスター構造から定まるPL構造を持つが、一方で曲面の測度付き葉層構造の空間にはトレイントラックと呼ばれるグラフを用いたPL構造が定まることが知られている。
        本講演では、Goncharov-Shenのクラスター多様体上のLandau-Ginzburgポテンシャル関数のトロピカル化を通してトレイントラックを翻訳し、2つのPL構造が同値であることを確認する。
        またこのトレイントラックの翻訳を通して、一般の擬Anosov写像類が符号安定性と呼ばれる性質を持つことを説明する。`,
        lang: "jp",
        access: {
            id: `820 6834 6105`,
            psw: `039914`,
        },
        record: {
            slides: `TNA/2023/Kano-Tropical_cluster_transformations_and_train_track_splittings.pdf`,
        },
    },
    {
        ymd: "2022-10-20",
        start: "1640",
        title: `A surface and a threefold with equivalent singularity categories`,
        speaker: "Martin Kalck",
        affil: "Freiburg University",
        web: "http://home.mathematik.uni-freiburg.de/kalck/",
        abstract: `<p>We discuss a triangle equivalence between singularity categories of an
        affine surface and an affine threefold.
        Both are isolated cyclic quotient singularities.
        This seems to be the first (non-trivial) example of a singular
        equivalence involving varieties of even and odd Krull dimension.</p>
        
        <p>The same approach recovers a result of Dong Yang showing a singular
        equivalence between certain cyclic quotient singularities in dimension
        2 and certain finite dimensional commutative algebras.</p>
        
        <p>This talk is based on <a href="https://arxiv.org/pdf/2103.06584.pdf">https://arxiv.org/pdf/2103.06584.pdf</a></p>`,
        lang: "en",
        access: {
            id: `896 4970 4419`,
            psw: `130543`,
        },
        record: {
            slides: `TNA/2022/Kalck-Surface_and_threefold_with_equivalent_singularity_categories.pdf`,
        },
    },
    {
        ymd: "2022-07-20",
        start: "1030",
        title: `Grothendieck enriched categories`,
        speaker: "Yuki Imamura 今村悠希",
        affil: "Osaka University 大阪大学",
        abstract: `Grothendieck圏は、入射的余生成子の存在や随伴関手定理の成立など、アーベル圏の中でも特に良い性質を持つことで知られる。通常Grothendieck圏は、生成子を持つ余完備なアーベル圏であって、フィルター余極限を取る関手が完全関手になるような圏として内在的な性質で以て定義されるが、加群圏の"良い部分圏"として実現できるという外在的な特徴づけ(Gabriel-Popescuの定理)も存在する。アーベル圏が自然なプレ加法圏(アーベル群の圏Ab上の豊穣圏)の構造を持つことから、Gabriel-Popescuの定理はAb-豊穣圏に対する定理だと思うことができる。本講演では、より一般のGrothendieckモノイダル圏V上の豊穣圏に対してGabriel-Popescuの定理の一般化を定式化し証明する。特にVとしてアーベル群の複体の圏Chを取ることによりGrothendieck圏のdg圏類似とそのGabriel-Popescuの定理が得られることも確認する。`,
        lang: "jp",
        access: {
            id: `814 5195 3418`,
            psw: `166305`,
        },
        record: {
            slides: `TNA/2022/Imamura-Grothendieck_enriched_categories.pdf`,
        },
    },
    {
        ymd: "2022-07-06",
        start: "1030",
        id: "nickSeries3",
        title: `Cyclic polytopes and higher Auslander--Reiten theory 3`,
        speaker: "Nicholas Williams",
        affil: "University of Tokyo 東京大学",
        web: "https://nchlswllms.github.io/",
        abstract: `This continues <a href="#nickSeries2">part 2</a>.
        In the third talk, we consider the relationship between the objects
from the first two talks. We explain how triangulations of
even-dimensional cyclic polytopes may be interpreted in terms of
tilting modules, cluster-tilting objects, or d-silting complexes. We
then proceed in the d-silting framework, and show how the higher
Stasheff--Tamari orders may be interpreted algebraically for even
dimensions. We explain how this allows one to interpret
odd-dimensional triangulations algebraically, namely, as equivalence
classes of d-maximal green sequences. We briefly digress to consider
the issue of equivalence of maximal green sequences itself. We then
show how one can interpret the higher Stasheff--Tamari orders on
equivalence classes of d-maximal green sequences. We finish by drawing
out some consequences of this algebraic interpretation of the higher
Stasheff--Tamari orders.`,
        lang: "en",
        access: {
            id: `812 0508 5626`,
            psw: `826814`,
        },
        record: {
            slides: `TNA/2022/Williams-Cyclic_polytopes_and_higher_AR_theory3.pdf`,
        },
    },
    {
        ymd: "2022-06-29",
        start: "1030",
        id: "nickSeries2",
        title: `Cyclic polytopes and higher Auslander--Reiten theory 2`,
        speaker: "Nicholas Williams",
        affil: "University of Tokyo 東京大学",
        web: "https://nchlswllms.github.io/",
        abstract: `This continues <a href="#nickSeries1">part 1</a>.
        In the second talk, we focus on higher Auslander--Reiten theory. We
        survey the basic setting of this theory, starting with
        d-cluster-tilting subcategories of module categories. We then move on
        to d-cluster-tilting subcategories of derived categories in the case
        of d-representation-finite d-hereditary algebras. We explain how one
        can construct (d + 2)-angulated cluster categories for such algebras,
        generalising classical cluster categories. We finally consider the
        d-almost positive category, which is the higher generalisation of the
        category of two-term complexes. Throughout, we illustrate the results
        using the higher Auslander algebras of type A, and explain how the
        different categories can be interpreted combinatorially for these
        algebras.`,
        lang: "en",
        access: {
            id: `812 0508 5626`,
            psw: `826814`,
        },
        record: {
            slides: `TNA/2022/Williams-Cyclic_polytopes_and_higher_AR_theory2.pdf`,
        },
    },
    {
        ymd: "2022-06-22",
        start: "1700",
        title: `Update on singular equivalences between commutative rings`,
        speaker: "Martin Kalck",
        affil: "Freiburg University",
        web: "http://home.mathematik.uni-freiburg.de/kalck/",
        abstract: `<p>We will start with an introduction to singularity categories, which
        were first studied by Buchweitz and later rediscovered by Orlov.
        Then we will explain what is known about triangle equivalences between
        singularity categories of commutative rings, recalling results of
        Knörrer, D. Yang (based on our joint works on relative singularity
        categories. This result also follows from work of Kawamata and was
        generalized in a joint work with Karmazyn) and a new equivalence
        obtained in arXiv:2103.06584.</p>        
        <p>
        In the remainder of the talk, we will focus on the case of Gorenstein
        isolated singularities and especially hypersurfaces, where we give a
        complete description of quasi-equivalence classes of dg enhancements
        of singularity categories, answering a question of Keller & Shinder.
        This is based on arXiv:2108.03292.</p>`,
        lang: "en",
        access: {
            id: `864 8429 4885`,
            psw: `825732`,
        },
        record: {
            slides: `TNA/2022/Kalck-Update_on_singular_equivalences_between_commutative_rings.pdf`,
        },
    },
    {
        ymd: "2022-06-15",
        start: "1030",
        id: "nickSeries1",
        title: `Cyclic polytopes and higher Auslander--Reiten theory 1`,
        speaker: "Nicholas Williams",
        affil: "University of Tokyo 東京大学",
        web: "https://nchlswllms.github.io/",
        abstract: `<p>In this series of three talks, we expand upon the previous talk (see <a href="http://www.math.nagoya-u.ac.jp/~aaron.chan/TNA/2021/Williams-Cyclic_polytopes_and_higher_AR.pdf">slides here</a>) given
        at the seminar and study the relationship between cyclic polytopes and
        higher Auslander--Reiten theory in more detail.
        </p>
        
        <p>In the first talk, we focus on cyclic polytopes. We survey important
        properties of cyclic polytopes, such as different ways to construct
        them, the Upper Bound Theorem, and their Ramsey-theoretic properties.
        We then move on to triangulations of cyclic polytopes. We give
        efficient combinatorial descriptions of triangulations of
        even-dimensional and odd-dimensional cyclic polytopes, which we will
        use in subsequent talks. We finally define the higher Stasheff--Tamari
        orders on triangulations of cyclic polytopes. We give important
        results on the orders, including Rambau's Theorem, and the equality of
        the two orders.</p>`,
        lang: "en",
        access: {
            id: `812 0508 5626`,
            psw: `826814`,
        },
        record: {
            slides: `TNA/2022/Williams-Cyclic_polytopes_and_higher_AR_theory1.pdf`,
        },
    },
    {
        ymd: ["2022-06-01", "2022-06-08"],
        start: ["1030", "1030"],
        title: `超平面配置の特性準多項式`,
        id: "Yoshinaga202206a",
        speaker: "Masahiko Yoshinaga 吉永 正彦",
        affil: "Osaka University 大阪大学",
        web: "http://www4.math.sci.osaka-u.ac.jp/~yoshinaga/index.html",
        abstract: `$n$ ベクトル空間内の $(n-1)$ 次元（アフィン）部分空間のいくつかの集まりを超平面配置という。ルート系、コクセター群、配置空間など様々な文脈で自然に表れる対象である。超平面配置の重要な不変量の一つとして「特性多項式」が挙げられる。特性多項式は（実配置の）部屋数、（複素配置の）補集合のポアンカレ多項式、（有限体上の）点の数など様々な情報を持っている。本講演では、アフィンルート系のある種の有限部分配置を主な対象に、特性多項式の性質や計算方法を、特に 2007年に Kamiya-Takemura-Terao により導入された「特性準多項式」に焦点をあてて紹介する。特性準多項式は特性多項式の精密化であるだけでなく、当初から多面体のEhrhart理論（格子点の数え上げ理論）との密接な関係が示唆されていた。特性多項式よりは複雑で扱いにくい側面もあるが、その複雑さの中に、代数的トーラス内のトーラス配置の位相幾何的情報や多面体の対称性に関する情報が見えてくるという最近の研究を紹介したい。`,
        lang: "jp",
        access: {
            id: `816 4624 3436`,
            psw: `182732`,
        },
        record: {
            slides: `TNA/2022/Yoshinaga-Quasipolynomial_of hyperplane_arrangements.pdf`,
        },
    },
    {
        ymd: "2022-04-13",
        start: "1030",
        title: `Tilting ideals of deformed preprojective algebras`,
        speaker: "Yuta Kimura 木村 雄太",
        affil: "Osaka Metropolitan University 大阪公立大学",
        abstract: `<p>Let $K$ be a field and $Q$ a finite quiver.
        For a weight $\\lambda \\in K^{|Q_0|}$, the deformed preprojective
        algebra $\\Pi^{\\lambda}$ was introduced by Crawley-Boevey and Holland
        to study deformations of Kleinian singularities.
        If $\\lambda = 0$, then $\\Pi^{0}$ is the preprojective algebra
        introduced by Gelfand-Ponomarev, and appears in many areas of
        mathematics.
        Among interesting properties of $\\Pi^{0}$, the classification of
        tilting ideals of $\\Pi^{0}$, shown by Buan-Iyama-Reiten-Scott, is
        fundamental and important.
        They constructed a bijection between the set of tilting ideals of
        $\\Pi^{0}$ and the Coxeter group $W_Q$ of $Q$.</p>
        <p>
        In this talk, when $Q$ is non-Dynkin, we see that $\\Pi^{\\lambda}$ is a
        $2$-Calabi-Yau algebra, and show that there exists a bijection between
        tilting ideals and a Coxeter group.
        However $W_Q$ does not appear, since $\\Pi^{\\lambda}$ is not necessarily basic.
        Instead of $W_Q$, we consider the Ext-quiver of rigid simple modules,
        and use its Coxeter group.
        When $Q$ is an extended Dynkin quiver, we see that the Ext-quiver is
        finite and this has information of singularities of a
        representation space of semisimple modules.
        This is joint work with William Crawley-Boevey.</p>`,
        lang: "jp",
        access: {
            id: `893 7563 9538`,
            psw: `069232`,
        },
        record: {
            slides: `TNA/2022/Kimura-Tilting_ideals_of_deformed_preprojective_algebras.pdf`,
        },
    },
];

let talkList = "",
    pastList = "";

let docTalkList = document.getElementById("talkList");
let docPastList = document.getElementById("pastList");

//const defaultStartTime = ["10", "30"];
const daysString = [
    "Sun 日",
    "Mon 月",
    "Tue 火",
    "Wed 水",
    "Thu 木",
    "Fri 金",
    "Sat 土",
    "Sun 日",
];

// ***** Determine time offset
const ourZone = "Asia/Tokyo";
//const ourZone = "Asia/Pyongyang";
//const ourZone = "Europe/Paris";
//const ourZone = "America/New_York";
let localtime = luxon.DateTime.local();
let ourtime = localtime.setZone(ourZone);
const sameTime = ourtime.offset == localtime.offset;
if (ourZone !== localtime.zoneName) {
    document.getElementById(
        "timeInfo"
    ).innerHTML = `<p>Date/time are displayed in your timezone (<b>${localtime.zoneName}, ${localtime.offsetNameShort}</b>).<br/>
    Our timezone is ${ourZone} (${ourtime.offsetNameShort})</p>`;
}

const expandToArr = (val, len) =>
    Array.isArray(val) ? val : Array(len).fill(val);
const isISODate = (d) =>
    d.match(/^\d{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])$/);
/**
 * @param  {string} date (in ISO format "yyyy-mm-dd")
 * @param  {string} start (4 character string "hhmm", or empty)
 */
const toDateTimeObj = (date, start) => {
    let timeSubstr =
        start !== "" ? `${start.slice(0, 2)}:${start.slice(2, 4)}` : "13:00";
    return luxon.DateTime.fromISO(`${date}T${timeSubstr}:00`, {
        zone: ourZone,
    });
};
/**
 *
 * @param {luxon.DateTime} dt - luxon DateTime object
 */
const simpleISOTime = (dt) =>
    dt.toISOTime({
        suppressSeconds: true,
        includeOffset: false,
    });
/**
 * @param  {luxon.DateTime} DT
 * @param  {boolean} hasStart
 * @param  {int} duration
 * @param  {string} zone adjust DT to zone
 */
function getDTString(DT, hasStart, duration, zone) {
    let t = zone !== ourZone ? DT.setZone(zone) : DT; //adjust start time if needed
    let day = zone !== ourZone ? t.toFormat("EEE") : daysString[t.weekday];

    let endt = t.plus({ minutes: duration });
    let spant = hasStart
        ? `${simpleISOTime(t)} ~ ${
              endt.hasSame(t, "day") ? "" : "+1day "
          }${simpleISOTime(endt)}`
        : `Time TBC`;

    return `${t.toISODate()} (${day}) ${spant}`;
}

function timeDataToHTML(ymd, start, duration) {
    let str = "",
        inSchedule = true;
    if (isISODate(ymd)) {
        let hasStart = start !== "" && start !== "TBC";
        let dt = toDateTimeObj(ymd, hasStart ? start : "");
        str = getDTString(
            dt,
            hasStart,
            duration,
            sameTime ? ourZone : localtime.zoneName
        );

        inSchedule = localtime.valueOf() <= dt.plus({ minutes: 30 }).valueOf();
        str +=
            sameTime || !inSchedule
                ? ""
                : ` <span style='color:#D0D0D0;'>[<abbr title=" ${getDTString(
                      dt,
                      hasStart,
                      duration,
                      ourZone
                  )} "> In our time: </abbr>]</span>`;
    } else {
        str = ymd;
    }
    return [str, inSchedule];
}

// ***** Actual page generation starts here
for (let talk of talks) {
    let str = `<fieldset ${
        "id" in talk ? 'id="' + talk.id + '"' : ""
    }><legend>`;
    let inSchedule = true;
    if (Array.isArray(talk.ymd)) {
        let startArr = expandToArr(
            "start" in talk ? talk.start : "",
            talk.ymd.length
        );
        let durArr = expandToArr(
            "duration" in talk ? talk.duration : 90,
            talk.ymd.length
        );
        let lastTalk = [
            talk.ymd.slice(-1)[0],
            startArr.slice(-1)[0],
            durArr.slice(-1)[0],
        ];
        inSchedule = timeDataToHTML(lastTalk[0], lastTalk[1], lastTalk[2])[1];
        let lines = [];
        for (let [i, ymd] of talk.ymd.entries()) {
            let [s, isFuture] = timeDataToHTML(ymd, startArr[i], durArr[i]);
            s =
                isFuture || !inSchedule
                    ? `Talk ${i + 1}: ${s}`
                    : `<span style='color:#D0D0D0;text-decoration: line-through;'>Talk ${
                          i + 1
                      }: ${s} </span>`;
            lines.push(s);
        }
        str += lines.join("<br/>");
        str += `</legend>`;
    } else {
        let [s, b] = timeDataToHTML(
            talk.ymd,
            "start" in talk ? talk.start : "",
            "duration" in talk ? talk.duration : 90
        );
        inSchedule = b;
        str += `${s}</legend>`;
    }

    // start piecing data entry
    str += `<ul class="twocolumns left80 leftbold">`;
    str += `<li><div class="leftcolumn">Title:</div><div class="maincolumn">${talk.title}</div></li>`;
    let affilString = "affil" in talk ? ` (${talk.affil})` : "";
    let spString =
        "web" in talk
            ? `<a href=${talk.web}>${talk.speaker}${affilString}</a>`
            : `${talk.speaker}${affilString}`;
    str += `<li><div class="leftcolumn">Speaker:</div><div class="maincolumn">${spString}</div></li>`;
    str += `<li><div class="leftcolumn">Abstract:</div><div class="maincolumn">${talk.abstract}</div></li>`;
    str += `<li><div class="leftcolumn">Language:</div><div class="maincolumn">${
        talk.lang === "jp" ? "Japanese 日本語" : "English"
    }</div></li>`;
    if ("access" in talk) {
        let linkurl =
            "link" in talk.access
                ? talk.access.link
                : "id" in talk.access
                ? `https://u-tokyo-ac-jp.zoom.us/j/${talk.access.id.replaceAll(
                      /[\s\xA0\uFEFF\u180E\u2000-\u200A\u202F\u205F\u3000]+/g,
                      ""
                  )}`
                : "";
        let label = "custom" in talk.access ? talk.access.custom : "Zoom";
        let showlink = inSchedule
            ? `[&nbsp;<a href="${linkurl}" target="_blank">${label}</a>&nbsp;]&nbsp;`
            : `<b>Zoom </b>`;

        let accessString =
            linkurl === ""
                ? "TBC"
                : `${showlink}<b>ID</b>&nbsp;${talk.access.id}&nbsp;`;

        accessString +=
            "psw" in talk.access
                ? `<b>Password</b>&nbsp;${talk.access.psw}&nbsp;`
                : "";

        str +=
            accessString === ""
                ? ""
                : `<li><div class="leftcolumn">Access:</div><div class="maincolumn">${accessString}</div></li>`;
    }

    if ("record" in talk) {
        str += `<li><div class="leftcolumn">Record:</div><div class="maincolumn">`;
        if ("slides" in talk.record) {
            str +=
                talk.record.slides === "contact"
                    ? "Contact speaker for slides. "
                    : `<a href="${talk.record.slides}">${
                          "slideDesc" in talk.record
                              ? talk.record.slideDesc
                              : "Slides here"
                      }</a>. `;
        } else {
            str += "No slide will be made available. ";
        }
        //str += ("vid" in talk.record)?`<a href="${talk.record.vid}">Video</a>. `:"Video not available.";
        str += `</div></li>`;
    }
    str += `</ul></fieldset>`;

    inSchedule ? (talkList = str + talkList) : (pastList += str);

    docTalkList.innerHTML = `<p>Loading talks...</p>` + talkList;
    docPastList.innerHTML = `<p>Loading talks...</p>` + pastList;
}

docTalkList.innerHTML = talkList;
docPastList.innerHTML = pastList;
// console.log(MathJax);
// MathJax.typeset();

/*** Smooth scroll shortcut ***/
function smScroll(to) {
    let y = document.getElementById(to).offset - 5;
    window.scrollTo({ top: y, behaviour: "smooth" });
}

/****  Scroll to top ****/
//Get the button:
btnToTop = document.getElementById("btnToTop");

// When the user scrolls down 20px from the top of the document, show the button
window.addEventListener("scroll", () => {
    if (
        document.body.scrollTop > 20 ||
        document.documentElement.scrollTop > 20
    ) {
        btnToTop.style.display = "block";
    } else {
        btnToTop.style.display = "none";
    }
});

let scrollToPos = document.getElementById("sec:schedule").offsetTop - 10; //give 10px padding to top
btnToTop.addEventListener("click", () => {
    window.scrollTo({ top: scrollToPos, behavior: "smooth" });
});

document.addEventListener(`click`, (e) => {
    if (e.target.tagName.toLowerCase() === "a") {
        //e.preventDefault();
        //console.log(`You clicked ${e.target.href}`);
        let anc = e.target.href.split("#").pop();
        let elt = document.getElementById(anc);
        if (elt.classList.contains("highlighted")) {
            elt.classList.remove("highlighted");
        }
        elt.classList.add("highlighted");
        elt.addEventListener("animationend", () => {
            elt.classList.remove("highlighted");
        });
    }
});

/* FOR COPY AND PASTE:
{ 
    ymd: "2000-01-01",
    start: "1600",
    duration: "90",
    title: "TBC",
    speaker: "ABC Suzuki",
    web: "http://www.math.nagoya-u.ac.jp/"
    affil: "Nagoya",
    abstract: "TBC",
    lang: "jp",
    access: {"id": "123&nbsp;345&nbsp;6789", "psw":"4321", 
            "link":"http://www.math.nagoya-u.ac.jp", 
            "custom": "SEE HERE"}
    record: {"slides" : "Contact speaker/link", "vid": "link"}
}
*/

/*
data structure:  
"ymd": "YYYY-MM-DD",  can be an array for lecture series
"id": string  (use if need anchoring)
"start": "hhmm" 24hr format  (NOTE: this is in Asia/Tokyo timezone), can be array for lecture series
"duration": optional number representing duration in mintue (default to 90, i.e. 1.5hr), can be array for lecture series
"title": string
"speaker": string
"web": string (to speaker's webpage)
"affil": optional (speaker affiliation)
"abstract": string possibly with HTML code
"lang": optional (default to "en") can only take "en" or "jp" for now
"access": { "id": string, "psw": string, "link": string, "custom": string }  all entry optional (leave blank = TBC)
"record": { "slides": string ("contact" or provide link), "vid": string (provide link, leave blank = display "No video recorded" } (leave blank = don't display)

about acess data:
id, psw = zoom id/zoom psw
link = provide link (anchor to custom text)
custom = any string for extra info (can be HTML)

***** 1st entry of array  = NEWEST TALK *******
*/
